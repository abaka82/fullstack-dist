{"version":3,"sources":["../../../client/components/auth/router.decorator.js"],"names":[],"mappings":"AAAA;;AAEA,CAAC,YAAW;;AAEZ,UAAQ,MAAR,CAAe,wBAAf,EACG,GADH,CACO,UAAS,UAAT,EAAqB,MAArB,EAA6B,IAA7B,EAAmC;;AAEtC,eAAW,GAAX,CAAe,mBAAf,EAAoC,UAAS,KAAT,EAAgB,IAAhB,EAAsB;AACxD,UAAI,CAAC,KAAK,YAAL,EAAmB;AACtB,eADsB;OAAxB;;AAIA,UAAI,OAAO,KAAK,YAAL,KAAsB,QAA7B,EAAuC;AACzC,aAAK,OAAL,CAAa,KAAK,YAAL,EAAmB,EAAE,IAAF,CAAhC,CAAwC,IAAxC,CAA6C,eAAO;AAClD,cAAI,GAAJ,EAAS;AACP,mBADO;WAAT;;AAIA,gBAAM,cAAN,GALkD;AAMlD,iBAAO,KAAK,UAAL,CAAgB,EAAE,IAAF,CAAhB,CAAwB,IAAxB,CAA6B,cAAM;AACxC,mBAAO,EAAP,CAAU,KAAK,OAAL,GAAe,OAAf,CAAV,CADwC;WAAN,CAApC,CANkD;SAAP,CAA7C,CADyC;OAA3C,MAWO;AACL,aAAK,UAAL,CAAgB,EAAE,IAAF,CAAhB,CAAwB,IAAxB,CAA6B,cAAM;AACjC,cAAI,EAAJ,EAAQ;AACN,mBADM;WAAR;;AAIA,gBAAM,cAAN,GALiC;AAMjC,iBAAO,EAAP,CAAU,OAAV,EANiC;SAAN,CAA7B,CADK;OAXP;KALkC,CAApC,CAFsC;GAAnC,CADP,CAFY;CAAX,CAAD","file":"router.decorator.js","sourcesContent":["'use strict';\r\n\r\n(function() {\r\n\r\nangular.module('meanonlineshopApp.auth')\r\n  .run(function($rootScope, $state, Auth) {\r\n    // Redirect to login if route requires auth and the user is not logged in, or doesn't have required role\r\n    $rootScope.$on('$stateChangeStart', function(event, next) {\r\n      if (!next.authenticate) {\r\n        return;\r\n      }\r\n\r\n      if (typeof next.authenticate === 'string') {\r\n        Auth.hasRole(next.authenticate, _.noop).then(has => {\r\n          if (has) {\r\n            return;\r\n          }\r\n\r\n          event.preventDefault();\r\n          return Auth.isLoggedIn(_.noop).then(is => {\r\n            $state.go(is ? 'login' : 'login');\r\n          });\r\n        });\r\n      } else {\r\n        Auth.isLoggedIn(_.noop).then(is => {\r\n          if (is) {\r\n            return;\r\n          }\r\n\r\n          event.preventDefault();\r\n          $state.go('login');\r\n        });\r\n      }\r\n    });\r\n  });\r\n\r\n})();\r\n"]}