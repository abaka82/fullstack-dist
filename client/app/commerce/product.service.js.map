{"version":3,"sources":["../../../client/app/commerce/product.service.js"],"names":[],"mappings":";;;;;;;;;;;;;;;AAgBA;;AAEA,QAAQ,MAAR,CAAe,mBAAf,EACG,OADH,CACW,SADX,EACsB,UAAU,SAAV,EAAqB,QAArB,EAA+B,MAA/B,EAAuC,EAAvC,EAA2C;AAC7D,MAAI,WAAW,UAAU,+BAAV,EAA2C,IAA3C,EAAiD;AAC9D,cAAU,EAAE,QAAQ,KAAR,EAAZ;AACA,eAAU,EAAE,QAAQ,KAAR,EAAe,SAAS,IAAT;AACzB,cAAQ;AACN,oBAAY,SAAZ;OADF;KADF;AAKA,cAAU,EAAE,QAAQ,KAAR,EAAe,SAAS,IAAT;AACzB,cAAQ;AACN,oBAAY,QAAZ;OADF;KADF;GAPa,CAAX,CADyD;;AAe7D,WAAS,MAAT,GAAkB,UAAS,IAAT,EAAe,SAAf,EAA0B;AAC1C,QAAI,IAAI,GAAG,KAAH,EAAJ,CADsC;;AAG1C,QAAI,QAAQ,CAAC,KAAK,MAAL,EAAa;AACxB,cAAQ,GAAR,CAAY,UAAZ,EADwB;AAExB,WAAK,MAAL,GAAc,OAAO,MAAP,CAAc;AAC1B,aAAK,mBAAiB,SAAjB,GAA2B,SAA3B;AACL,cAAM,IAAN;AACA,gBAAQ,MAAR;AACA,iBAAS,EAAC,gBAAgB,qBAAhB,EAAV;OAJY,CAAd,CAFwB;AAQvB,cAAQ,GAAR,CAAY,aAAa,SAAb,CAAZ,CARuB;AASxB,WAAK,MAAL,CAAY,IAAZ,CAAiB,UAAU,QAAV,EAAoB;AACnC,iBAAS,YAAY;AACnB,YAAE,OAAF,CAAU,SAAS,IAAT,CAAV,CADmB;SAAZ,CAAT,CADmC;OAApB,EAId,UAAU,QAAV,EAAoB;AACrB,YAAI,SAAS,MAAT,GAAkB,CAAlB,EAAoB;AACtB,YAAE,MAAF,CAAS,QAAT,EADsB;SAAxB;OADC,CAJH,CATwB;AAkBzB,cAAQ,GAAR,CAAY,UAAZ,EAlByB;AAmBxB,WAAK,MAAL,CAAY,QAAZ,CAAqB,UAAU,GAAV,EAAe;AAClC,UAAE,MAAF,CAAS,EAAC,UAAU,KAAK,GAAL,CAAS,GAAT,EAAc,SAAS,QAAQ,IAAI,MAAJ,GAAa,IAAI,KAAJ,CAA5C,CAAV,EAAV,EAA8E,GAA9E,EADkC;OAAf,CAArB,CAnBwB;KAA1B,MAsBO;AACL,QAAE,MAAF,CAAS,OAAO,KAAK,MAAL,GAAc,iBAArB,CAAT,CADK;KAtBP;AAyBA,WAAO,EAAE,OAAF,CA5BmC;GAA1B,CAf2C;;AA8C7D,SAAO,QAAP,CA9C6D;CAA3C,CADtB","file":"product.service.js","sourcesContent":["/*'use strict';\r\n\r\n(function() {\r\n\r\nfunction ProductResource($resource) {\r\n  return $resource('/api/products/:id/:controller', {\r\n    id: '@_id'\r\n  });\r\n}\r\n\r\nangular.module('meanonlineshopApp.productGrid')\r\n  .factory('Product', ProductResource);\r\n\r\n})();*/\r\n\r\n\r\n'use strict';\r\n\r\nangular.module('meanonlineshopApp')\r\n  .factory('Product', function ($resource, $timeout, Upload, $q) {\r\n    var resource = $resource('/api/products/:id/:controller', null, {\r\n      'update': { method: 'PUT'},\r\n      'catalog':{ method: 'GET', isArray: true,\r\n        params: {\r\n          controller: 'catalog'\r\n        }\r\n      },\r\n      'search': { method: 'GET', isArray: true,\r\n        params: {\r\n          controller: 'search'\r\n        }\r\n      }\r\n    });\r\n\r\n    resource.upload = function(file, productId) {\r\n      var d = $q.defer();\r\n\r\n      if (file && !file.$error) {\r\n        console.log(\"upload 1\");\r\n        file.upload = Upload.upload({\r\n          url: '/api/products/'+productId+'/upload',\r\n          file: file,\r\n          method: 'POST',\r\n          headers: {'Content-Type': 'multipart/form-data'}\r\n        });\r\n         console.log(\"upload 2\" + productId);\r\n        file.upload.then(function (response) {\r\n          $timeout(function () {\r\n            d.resolve(response.data);\r\n          });\r\n        }, function (response) {\r\n          if (response.status > 0){\r\n            d.reject(response);\r\n          }\r\n        });\r\n       console.log(\"upload 3\"); \r\n        file.upload.progress(function (evt) {\r\n          d.notify({progress: Math.min(100, parseInt(100.0 * evt.loaded / evt.total))}, evt);\r\n        });\r\n      } else {\r\n        d.reject(file ? file.$error : 'No picture file');\r\n      }\r\n      return d.promise;\r\n    };\r\n\r\n    return resource;\r\n  });\r\n\r\n"]}