{"version":3,"sources":["../../../../client/app/admin/product/admin.product.controller.js"],"names":[],"mappings":"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","file":"admin.product.controller.js","sourcesContent":["'use strict';\r\n\r\n\r\nvar errorHandler;\r\n\r\n  errorHandler = function ($scope){\r\n  return function error(httpResponse){\r\n    console.log('failed: ', httpResponse);\r\n    $scope.errors = httpResponse;\r\n  };\r\n};\r\n\r\nangular.module('meanonlineshopApp')\r\n  .controller('AdminProductController', function ($scope, User, $filter, $state, $http, toastr, Product, $stateParams, ngTableParams) {\r\n\r\n var orderBy = $filter('orderBy');\r\n\r\n          $scope.order = function(predicate) {\r\n            $scope.reverse = ($scope.predicate === predicate) ? !$scope.reverse : false;\r\n            $scope.predicate = predicate;\r\n          };\r\n         $scope.listProductTable = new ngTableParams({\r\n                page: 1,\r\n                count: 5\r\n            }, {\r\n                total: 0, // length of data\r\n                getData: function ($defer, params) {\r\n                    // Use the User $resource to fetch all users\r\n                    Product.query({}, function(response) {\r\n                      $scope.products = response;\r\n                      $scope.data = $scope.products.slice((params.page() - 1) * params.count(), params.page() * params.count());\r\n                      params.total($scope.products.length); // set total for recalc pagination\r\n                      $defer.resolve($scope.data);\r\n                    });\r\n                }\r\n            });\r\n\r\n    $scope.product = {}; // create a new instance\r\n    $scope.addProduct = function(form){\r\n        $scope.submitted = true;    \r\n      if (form.$valid) {\r\n        if ( typeof $scope.product.picture === 'undefined')\r\n        {\r\n             // create product without image\r\n            return Product.save($scope.product).$promise\r\n            .then(function (product) {\r\n                toastr.success('New product has been added successfully');\r\n                $state.go('admin.list_product');\r\n            }).catch(function (err) {\r\n                toastr.error(err.data.message, 'There is an error');\r\n            });\r\n        }\r\n       else\r\n       { \r\n            // upload and create product with image\r\n            return Product.save($scope.product).$promise.then(function (product) {\r\n            return Product.upload($scope.product.picture, product._id);                \r\n            }).then(function (product) {\r\n                toastr.success('New product has been added successfully');\r\n                $state.go('admin.list_product');\r\n            }).catch(function (err) {\r\n                toastr.error(err.data.message, 'There is an error');\r\n            });\r\n       };\r\n     };\r\n    };\r\n\r\n      $scope.deleteProduct = function(productId) {\r\n           this.$http = $http;\r\n            this.$http.delete('/api/products/' + productId, {})\r\n              .success(function(result) {\r\n                  toastr.success('Product has been deleted successfully');\r\n                  $scope.listProductTable.reload();\r\n              }).catch(function (err) {\r\n                toastr.error(err.data.message, 'There is an error');\r\n              });            \r\n        }\r\n  \r\n      \r\n      $scope.idSelectedVote = null;\r\n      $scope.setSelected = function (idSelectedVote) {\r\n         $scope.idSelectedVote = idSelectedVote;\r\n      };\r\n\r\n       $scope.doCheck = function () {\r\n        if ($scope.product.Stock > 0) {\r\n            $scope.product.Status = \"Available\";\r\n            //status.value\r\n        }\r\n        else{\r\n          $scope.product.Status = \"Unavailable\";\r\n        }\r\n    }\r\n\r\n    $scope.showAll = function () {\r\n          $scope.data = $scope.products;\r\n    }\r\n    $scope.showPaging = function () {\r\n      if($scope.searchKeyword.Title == \"\"){\r\n           $scope.listProductTable.reload();\r\n\r\n    }\r\n  }\r\n})\r\n\r\n.directive('ngConfirmClick', [\r\n      function(){\r\n            return {\r\n                link: function (scope, element, attr) {\r\n                    var msg = attr.ngConfirmClick || \"Are you sure to delete this product??\";\r\n                    var clickAction = attr.confirmedClick;\r\n                    element.bind('click',function (event) {\r\n                        if ( window.confirm(msg) ) {\r\n                            scope.$eval(clickAction)\r\n                        }\r\n                    });\r\n                }\r\n            };\r\n}])\r\n\r\n\r\n\r\n.controller('EditProductController', function ($scope, User,  $state, $http, toastr, Product, Upload, $stateParams) {\r\n    // Use the Product $resource to fetch detail products\r\n    $scope.id = $stateParams.id\r\n    $scope.product = Product.get({id: $scope.id});\r\n\r\n    $scope.editProduct = function(form){\r\n        $scope.submitted = true; \r\n        if (form.$valid) {\r\n            if ( typeof $scope.product.picture === 'undefined')\r\n            {\r\n                // Update product without image\r\n                return Product.update({id: $scope.product._id}, $scope.product).$promise\r\n                .then(function (product) {\r\n                    toastr.success('Product has been updated successfully');\r\n                    $state.go('admin.list_product');\r\n                }).catch(function (err) {\r\n                    toastr.error(err.data.message, 'There is an error');\r\n                });\r\n            }\r\n        else\r\n            { \r\n                // Update product with image\r\n                return Product.update({id: $scope.product._id}, $scope.product).$promise.then(function (product) {\r\n                return Product.upload($scope.product.picture, product._id);                \r\n                }).then(function (product) {\r\n                    toastr.success('Product has been updated successfully');\r\n                    $state.go('admin.list_product');\r\n                }).catch(function (err) {\r\n                    toastr.error(err.data.message, 'There is an error');\r\n                });\r\n            };\r\n        };\r\n    };\r\n\r\n    $scope.doCheck = function () {\r\n        if ($scope.product.Stock > 0) {\r\n            $scope.product.Status = \"Available\";\r\n            //status.value\r\n        }\r\n        else{\r\n          $scope.product.Status = \"Unavailable\";\r\n        }\r\n    };\r\n\r\n  });\r\n"]}